# Copyright [2021] [Cargill, Incorporated.] 
# SPDX-License-Identifier: Apache-2.0
# lowercase fields
# if a field exists, and it is not an excluded key, lowercase it
# url field are already lowercased in url enrichment so don't redo
# Following fields are NOT lowercased:
# rule.uuid
# transaction.id
# event.reference
# package.reference
# rule.reference
# threat.tactic.reference
# threat.technique.reference
# vulnerability.reference
# dll.pe.original_file_name
# file.pe.original_file_name
# process.pe.original_file_name
# event.url
# url.original
# url.original.text
# log.original
# user_agent.original
# user_agent.original.text
# threat.technique.subtechnique.reference
# agent.build.original
# process.parent.pe.original_file_name
# event.original
filter {
  if "disable_lowercase_enrichment" in [tags] or "disable_data_quality" in [tags] or "disable_enrichments" in [tags] {
    mutate {
      remove_tag => ["disable_lowercase_enrichment"]
    }
  } else {
    mutate {
      lowercase => [
        "@timestamp",
        "agent.ephemeral_id",
        "agent.id",
        "agent.name",
        "agent.parse_rule",
        "agent.type",
        "agent.version",
        "client.address",
        "client.as.number",
        "client.as.organization.name",
        "client.as.organization.name.text",
        "client.bytes",
        "client.domain",
        "client.geo.city_name",
        "client.geo.continent_name",
        "client.geo.country_iso_code",
        "client.geo.country_name",
        "client.geo.location",
        "client.geo.name",
        "client.geo.region_iso_code",
        "client.geo.region_name",
        "client.ip",
        "client.mac",
        "client.nat.ip",
        "client.nat.port",
        "client.packets",
        "client.port",
        "client.registered_domain",
        "client.subdomain",
        "client.top_level_domain",
        "client.user.domain",
        "client.user.email",
        "client.user.full_name",
        "client.user.full_name.text",
        "client.user.group.domain",
        "client.user.group.id",
        "client.user.group.name",
        "client.user.hash",
        "client.user.id",
        "client.user.name",
        "client.user.name.text",
        "client.user.roles",
        "cloud.account.id",
        "cloud.account.name",
        "cloud.availability_zone",
        "cloud.instance.id",
        "cloud.instance.name",
        "cloud.machine.type",
        "cloud.project.id",
        "cloud.project.name",
        "cloud.provider",
        "cloud.region",
        "container.id",
        "container.image.name",
        "container.image.tag",
        "container.labels",
        "container.name",
        "container.runtime",
        "database.field_names",
        "database.instance",
        "database.name ",
        "database.table",
        "destination.address",
        "destination.as.number",
        "destination.as.organization.name",
        "destination.as.organization.name.text",
        "destination.bytes",
        "destination.domain",
        "destination.geo.city_name",
        "destination.geo.continent_name",
        "destination.geo.country_iso_code",
        "destination.geo.country_name",
        "destination.geo.location",
        "destination.geo.name",
        "destination.geo.region_iso_code",
        "destination.geo.region_name",
        "destination.ip",
        "destination.mac",
        "destination.nat.ip",
        "destination.nat.port",
        "destination.packets",
        "destination.port",
        "destination.registered_domain",
        "destination.subdomain",
        "destination.top_level_domain",
        "destination.user.domain",
        "destination.user.email",
        "destination.user.full_name",
        "destination.user.full_name.text",
        "destination.user.group.domain",
        "destination.user.group.id",
        "destination.user.group.name",
        "destination.user.hash",
        "destination.user.id",
        "destination.user.name",
        "destination.user.name.text",
        "destination.user.roles",
        "dll.code_signature.exists",
        "dll.code_signature.status",
        "dll.code_signature.subject_name",
        "dll.code_signature.trusted",
        "dll.code_signature.valid",
        "dll.hash.md5",
        "dll.hash.sha1",
        "dll.hash.sha256",
        "dll.hash.sha512",
        "dll.name",
        "dll.path",
        "dll.pe.architecture",
        "dll.pe.company",
        "dll.pe.description",
        "dll.pe.file_version",
        "dll.pe.imphash",
        "dll.pe.product",
        "dns.answers",
        "dns.answers.class",
        "dns.answers.data",
        "dns.answers.name",
        "dns.answers.ttl",
        "dns.answers.type",
        "dns.header_flags",
        "dns.id",
        "dns.op_code",
        "dns.question.class",
        "dns.question.name",
        "dns.question.registered_domain",
        "dns.question.subdomain",
        "dns.question.top_level_domain",
        "dns.question.type",
        "dns.resolved_ip",
        "dns.response_code",
        "dns.type",
        "ecs.version",
        "email.body",
        "email.header",
        "email.reply_to ",
        "email.src_display_name ",
        "email.subject",
        "email.x_mailer",
        "error.code",
        "error.id",
        "error.message",
        "error.stack_trace",
        "error.stack_trace.text",
        "error.type",
        "event.action",
        "event.category",
        "event.code",
        "event.created",
        "event.dataset",
        "event.duration",
        "event.end",
        "event.hash",
        "event.id",
        "event.ingested",
        "event.kind",
        "event.module",
        "event.outcome",
        "event.provider",
        "event.reason",
        "event.risk_score",
        "event.risk_score_norm",
        "event.sequence",
        "event.severity",
        "event.start",
        "event.timezone",
        "event.type",
        "file.accessed",
        "file.attributes",
        "file.code_signature.exists",
        "file.code_signature.status",
        "file.code_signature.subject_name",
        "file.code_signature.trusted",
        "file.code_signature.valid",
        "file.created",
        "file.ctime",
        "file.device",
        "file.directory",
        "file.drive_letter",
        "file.extension",
        "file.group",
        "file.hash.md5",
        "file.hash.sha1",
        "file.hash.sha256",
        "file.hash.sha512",
        "file.inode",
        "file.mime_type",
        "file.mode",
        "file.mtime",
        "file.name",
        "file.owner",
        "file.path",
        "file.path.text",
        "file.pe.architecture",
        "file.pe.company",
        "file.pe.description",
        "file.pe.file_version",
        "file.pe.imphash",
        "file.pe.product",
        "file.size",
        "file.target_path",
        "file.target_path.text",
        "file.type",
        "file.x509.alternative_names",
        "file.x509.issuer.common_name",
        "file.x509.issuer.country",
        "file.x509.issuer.distinguished_name",
        "file.x509.issuer.locality",
        "file.x509.issuer.organization",
        "file.x509.issuer.organizational_unit",
        "file.x509.issuer.state_or_province",
        "file.x509.not_after",
        "file.x509.not_before",
        "file.x509.public_key_algorithm",
        "file.x509.public_key_curve",
        "file.x509.public_key_exponent",
        "file.x509.public_key_size",
        "file.x509.serial_number",
        "file.x509.signature_algorithm",
        "file.x509.subject.common_name",
        "file.x509.subject.country",
        "file.x509.subject.distinguished_name",
        "file.x509.subject.locality",
        "file.x509.subject.organization",
        "file.x509.subject.organizational_unit",
        "file.x509.subject.state_or_province",
        "file.x509.version_number",
        "group.domain",
        "group.id",
        "group.name",
        "host.architecture",
        "host.domain",
        "host.geo.city_name",
        "host.geo.continent_name",
        "host.geo.country_iso_code",
        "host.geo.country_name",
        "host.geo.location",
        "host.geo.name",
        "host.geo.region_iso_code",
        "host.geo.region_name",
        "host.hostname",
        "host.id",
        "host.ip",
        "host.last_logged_in_user",
        "host.logged_in_users",
        "host.mac",
        "host.manufacturer",
        "host.model",
        "host.name",
        "host.os.family",
        "host.os.full",
        "host.os.full.text",
        "host.installation_date",
        "host.os.kernel",
        "host.os.name",
        "host.os.name.text",
        "host.os.platform",
        "host.os.version",
        "host.serial",
        "host.timezone",
        "host.type",
        "host.uptime",
        "host.user.domain",
        "host.user.email",
        "host.user.full_name",
        "host.user.full_name.text",
        "host.user.group.domain",
        "host.user.group.id",
        "host.user.group.name",
        "host.user.hash",
        "host.user.id",
        "host.user.name",
        "host.user.name.text",
        "host.user.roles",
        "http.request.body.bytes",
        "http.request.body.content",
        "http.request.body.content.text",
        "http.request.bytes",
        "http.request.method",
        "http.request.mime_type",
        "http.request.referrer",
        "http.response.body.bytes",
        "http.response.body.content",
        "http.response.body.content.text",
        "http.response.bytes",
        "http.response.mime_type",
        "http.response.status_code",
        "http.version",
        "labels",
        "log.file.path",
        "log.level",
        "log.logger",
        "log.origin.file.line",
        "log.origin.file.name",
        "log.origin.function",
        "log.source.hostname",
        "log.source.ip",
        "log.syslog",
        "log.syslog.facility.code",
        "log.syslog.facility.name",
        "log.syslog.priority",
        "log.syslog.severity.code",
        "log.syslog.severity.name",
        "message",
        "network.application",
        "network.bytes",
        "network.community_id",
        "network.direction",
        "network.forwarded_ip",
        "network.iana_number",
        "network.inner",
        "network.inner.vlan.id",
        "network.inner.vlan.name",
        "network.mac",
        "network.name",
        "network.packets",
        "network.protocol",
        "network.transport",
        "network.type",
        "network.vlan.id",
        "network.vlan.name",
        "observer.egress",
        "observer.egress.interface.alias",
        "observer.egress.interface.id",
        "observer.egress.interface.name",
        "observer.egress.vlan.id",
        "observer.egress.vlan.name",
        "observer.egress.zone",
        "observer.geo.city_name",
        "observer.geo.continent_name",
        "observer.geo.country_iso_code",
        "observer.geo.country_name",
        "observer.geo.location",
        "observer.geo.name",
        "observer.geo.region_iso_code",
        "observer.geo.region_name",
        "observer.hostname",
        "observer.ingress",
        "observer.ingress.interface.alias",
        "observer.ingress.interface.id",
        "observer.ingress.interface.name",
        "observer.ingress.vlan.id",
        "observer.ingress.vlan.name",
        "observer.ingress.zone",
        "observer.ip",
        "observer.mac",
        "observer.name",
        "observer.os.family",
        "observer.os.full",
        "observer.os.full.text",
        "observer.os.kernel",
        "observer.os.name",
        "observer.os.name.text",
        "observer.os.platform",
        "observer.os.version",
        "observer.product",
        "observer.serial_number",
        "observer.type",
        "observer.vendor",
        "observer.version",
        "organization.id",
        "organization.name",
        "organization.name.text",
        "package.architecture",
        "package.build_version",
        "package.checksum",
        "package.description",
        "package.install_scope",
        "package.installed",
        "package.license",
        "package.name",
        "package.path",
        "package.size",
        "package.type",
        "package.version",
        "process.args",
        "process.args_count",
        "process.code_signature.exists",
        "process.code_signature.status",
        "process.code_signature.subject_name",
        "process.code_signature.trusted",
        "process.code_signature.valid",
        "process.command_line",
        "process.command_line.text",
        "process.entity_id",
        "process.executable",
        "process.executable.text",
        "process.exit_code",
        "process.hash.md5",
        "process.hash.sha1",
        "process.hash.sha256",
        "process.hash.sha512",
        "process.name",
        "process.name.text",
        "process.parent.args",
        "process.parent.args_count",
        "process.parent.code_signature.exists",
        "process.parent.code_signature.status",
        "process.parent.code_signature.subject_name",
        "process.parent.code_signature.trusted",
        "process.parent.code_signature.valid",
        "process.parent.command_line",
        "process.parent.command_line.text",
        "process.parent.entity_id",
        "process.parent.executable",
        "process.parent.executable.text",
        "process.parent.exit_code",
        "process.parent.hash.md5",
        "process.parent.hash.sha1",
        "process.parent.hash.sha256",
        "process.parent.hash.sha512",
        "process.parent.name",
        "process.parent.name.text",
        "process.parent.pe.architecture",
        "process.parent.pe.company",
        "process.parent.pe.description",
        "process.parent.pe.file_version",
        "process.parent.pe.imphash",
        "process.parent.pe.product",
        "process.parent.pgid",
        "process.parent.pid",
        "process.parent.ppid",
        "process.parent.start",
        "process.parent.thread.id",
        "process.parent.thread.name",
        "process.parent.title",
        "process.parent.title.text",
        "process.parent.uptime",
        "process.parent.working_directory",
        "process.parent.working_directory.text",
        "process.pe.architecture",
        "process.pe.company",
        "process.pe.description",
        "process.pe.file_version",
        "process.pe.imphash",
        "process.pe.product",
        "process.pgid",
        "process.pid",
        "process.ppid",
        "process.start",
        "process.thread.id",
        "process.thread.name",
        "process.title",
        "process.title.text",
        "process.uptime",
        "process.working_directory",
        "process.working_directory.text",
        "registry.data.bytes",
        "registry.data.strings",
        "registry.data.type",
        "registry.hive",
        "registry.key",
        "registry.path",
        "registry.value",
        "related.hash",
        "related.hosts",
        "related.ip",
        "related.mac",
        "related.user",
        "rule.author",
        "rule.category",
        "rule.description",
        "rule.id",
        "rule.license",
        "rule.name",
        "rule.ruleset",
        "rule.version",
        "server.address",
        "server.as.number",
        "server.as.organization.name",
        "server.as.organization.name.text",
        "server.bytes",
        "server.domain",
        "server.geo.city_name",
        "server.geo.continent_name",
        "server.geo.country_iso_code",
        "server.geo.country_name",
        "server.geo.location",
        "server.geo.name",
        "server.geo.region_iso_code",
        "server.geo.region_name",
        "server.ip",
        "server.mac",
        "server.nat.ip",
        "server.nat.port",
        "server.packets",
        "server.port",
        "server.registered_domain",
        "server.subdomain",
        "server.top_level_domain",
        "server.user.domain",
        "server.user.email",
        "server.user.full_name",
        "server.user.full_name.text",
        "server.user.group.domain",
        "server.user.group.id",
        "server.user.group.name",
        "server.user.hash",
        "server.user.id",
        "server.user.name",
        "server.user.name.text",
        "server.user.roles",
        "service.ephemeral_id",
        "service.id",
        "service.name",
        "service.node.name",
        "service.state",
        "service.type",
        "service.version",
        "source.address",
        "source.as.number",
        "source.as.organization.name",
        "source.as.organization.name.text",
        "source.bytes",
        "source.domain",
        "source.geo.city_name",
        "source.geo.continent_name",
        "source.geo.country_iso_code",
        "source.geo.country_name",
        "source.geo.location",
        "source.geo.name",
        "source.geo.region_iso_code",
        "source.geo.region_name",
        "source.ip",
        "source.mac",
        "source.nat.ip",
        "source.nat.port",
        "source.packets",
        "source.port",
        "source.registered_domain",
        "source.subdomain",
        "source.top_level_domain",
        "source.user.domain",
        "source.user.email",
        "source.user.full_name",
        "source.user.full_name.text",
        "source.user.group.domain",
        "source.user.group.id",
        "source.user.group.name",
        "source.user.hash",
        "source.user.id",
        "source.user.name",
        "source.user.name.text",
        "source.user.roles",
        "span.id",
        "tags",
        "threat.framework",
        "threat.list.attribute_tag",
        "threat.list.comment",
        "threat.list.created",
        "threat.list.distribution",
        "threat.list.event_analysis",
        "threat.list.event_id",
        "threat.list.event_info",
        "threat.list.event_tag",
        "threat.list.ingested",
        "threat.list.ioc",
        "threat.list.member_org",
        "threat.list.object_category",
        "threat.list.object_name",
        "threat.list.object_relation",
        "threat.list.object_uuid",
        "threat.list.safe_to_enable_ids",
        "threat.list.severity_name",
        "threat.list.source_org",
        "threat.list.start",
        "threat.list.type",
        "threat.list.uuid",
        "threat.tactic.id",
        "threat.tactic.name",
        "threat.technique.id",
        "threat.technique.name",
        "threat.technique.name.text",
        "threat.technique.subtechnique.id",
        "threat.technique.subtechnique.name",
        "threat.technique.subtechnique.name.text",
        "tls.cipher",
        "tls.client.certificate",
        "tls.client.certificate_chain",
        "tls.client.hash.md5",
        "tls.client.hash.sha1",
        "tls.client.hash.sha256",
        "tls.client.issuer",
        "tls.client.ja3",
        "tls.client.not_after",
        "tls.client.not_before",
        "tls.client.server_name",
        "tls.client.subject",
        "tls.client.supported_ciphers",
        "tls.client.x509.alternative_names",
        "tls.client.x509.issuer.common_name",
        "tls.client.x509.issuer.country",
        "tls.client.x509.issuer.distinguished_name",
        "tls.client.x509.issuer.locality",
        "tls.client.x509.issuer.organization",
        "tls.client.x509.issuer.organizational_unit",
        "tls.client.x509.issuer.state_or_province",
        "tls.client.x509.not_after",
        "tls.client.x509.not_before",
        "tls.client.x509.public_key_algorithm",
        "tls.client.x509.public_key_curve",
        "tls.client.x509.public_key_exponent",
        "tls.client.x509.public_key_size",
        "tls.client.x509.serial_number",
        "tls.client.x509.signature_algorithm",
        "tls.client.x509.subject.common_name",
        "tls.client.x509.subject.country",
        "tls.client.x509.subject.distinguished_name",
        "tls.client.x509.subject.locality",
        "tls.client.x509.subject.organization",
        "tls.client.x509.subject.organizational_unit",
        "tls.client.x509.subject.state_or_province",
        "tls.client.x509.version_number",
        "tls.curve",
        "tls.established",
        "tls.next_protocol",
        "tls.resumed",
        "tls.server.certificate",
        "tls.server.certificate_chain",
        "tls.server.hash.md5",
        "tls.server.hash.sha1",
        "tls.server.hash.sha256",
        "tls.server.issuer",
        "tls.server.ja3s",
        "tls.server.not_after",
        "tls.server.not_before",
        "tls.server.subject",
        "tls.server.x509.alternative_names",
        "tls.server.x509.issuer.common_name",
        "tls.server.x509.issuer.country",
        "tls.server.x509.issuer.distinguished_name",
        "tls.server.x509.issuer.locality",
        "tls.server.x509.issuer.organization",
        "tls.server.x509.issuer.organizational_unit",
        "tls.server.x509.issuer.state_or_province",
        "tls.server.x509.not_after",
        "tls.server.x509.not_before",
        "tls.server.x509.public_key_algorithm",
        "tls.server.x509.public_key_curve",
        "tls.server.x509.public_key_exponent",
        "tls.server.x509.public_key_size",
        "tls.server.x509.serial_number",
        "tls.server.x509.signature_algorithm",
        "tls.server.x509.subject.common_name",
        "tls.server.x509.subject.country",
        "tls.server.x509.subject.distinguished_name",
        "tls.server.x509.subject.locality",
        "tls.server.x509.subject.organization",
        "tls.server.x509.subject.organizational_unit",
        "tls.server.x509.subject.state_or_province",
        "tls.server.x509.version_number",
        "tls.version",
        "tls.version_protocol",
        "url.full",
        "url.subdomain",
        "url.domain",
        "url.extension",
        "url.fragment",
        "url.full.text",
        "url.password",
        "url.path",
        "url.port",
        "url.query",
        "url.registered_domain",
        "url.scheme",
        "url.top_level_domain",
        "url.username",
        "user_agent.device.name",
        "user_agent.name",
        "user_agent.os.family",
        "user_agent.os.full",
        "user_agent.os.full.text",
        "user_agent.os.kernel",
        "user_agent.os.name",
        "user_agent.os.name.text",
        "user_agent.os.platform",
        "user_agent.os.version",
        "user_agent.version",
        "user.domain",
        "user.email",
        "user.full_name",
        "user.full_name.text",
        "user.group.domain",
        "user.group.id",
        "user.group.name",
        "user.hash",
        "user.id",
        "user.name",
        "user.name.text",
        "user.roles",
        "vulnerability.category",
        "vulnerability.classification",
        "vulnerability.description",
        "vulnerability.description.text",
        "vulnerability.enumeration",
        "vulnerability.id",
        "vulnerability.report_id",
        "vulnerability.scanner.vendor",
        "vulnerability.score.base",
        "vulnerability.score.environmental",
        "vulnerability.score.temporal",
        "vulnerability.score.version",
        "vulnerability.severity"
      ]
    }
  }
}
