# Copyright [2021] [Cargill, Incorporated.] 
# SPDX-License-Identifier: Apache-2.0
# remove empty fields and truncate all fields to 1024 bytes
filter {
  if "disable_ecs_data_type_enrichment" in [tags] or "disable_data_quality" in [tags] or "disable_enrichments" in [tags] {
    mutate {
      remove_tag => ["disable_ecs_data_type_enrichment"]
    }
  } else {
    # ECS dot notation to nested
    mutate {
      rename => { "agent.build.original" => "[agent][build][original]" }
      rename => { "agent.ephemeral_id" => "[agent][ephemeral_id]" }
      rename => { "agent.id" => "[agent][id]" }
      rename => { "agent.name" => "[agent][name]" }
      rename => { "agent.parse_rule" => "[agent][parse_rule]" }
      rename => { "agent.type" => "[agent][type]" }
      rename => { "agent.version" => "[agent][version]" }
      rename => { "assignee.user.email" => "[assignee][user][email]" }
      rename => { "assignee.user.name" => "[assignee][user][name]" }
      rename => { "client.address" => "[client][address]" }
      rename => { "client.as.number" => "[client][as][number]" }
      rename => { "client.as.organization.name" => "[client][as][organization][name]" }
      rename => { "client.as.organization.name.text" => "[client][as][organization][name][text]" }
      rename => { "client.bytes" => "[client][bytes]" }
      rename => { "client.domain" => "[client][domain]" }
      rename => { "client.geo.city_name" => "[client][geo][city_name]" }
      rename => { "client.geo.continent_code" => "[client][geo][continent_code]" }
      rename => { "client.geo.continent_name" => "[client][geo][continent_name]" }
      rename => { "client.geo.country_iso_code" => "[client][geo][country_iso_code]" }
      rename => { "client.geo.country_name" => "[client][geo][country_name]" }
      rename => { "client.geo.location" => "[client][geo][location]" }
      rename => { "client.geo.name" => "[client][geo][name]" }
      rename => { "client.geo.postal_code" => "[client][geo][postal_code]" }
      rename => { "client.geo.region_iso_code" => "[client][geo][region_iso_code]" }
      rename => { "client.geo.region_name" => "[client][geo][region_name]" }
      rename => { "client.geo.timezone" => "[client][geo][timezone]" }
      rename => { "client.ip" => "[client][ip]" }
      rename => { "client.mac" => "[client][mac]" }
      rename => { "client.nat.ip" => "[client][nat][ip]" }
      rename => { "client.nat.port" => "[client][nat][port]" }
      rename => { "client.packets" => "[client][packets]" }
      rename => { "client.port" => "[client][port]" }
      rename => { "client.registered_domain" => "[client][registered_domain]" }
      rename => { "client.subdomain" => "[client][subdomain]" }
      rename => { "client.top_level_domain" => "[client][top_level_domain]" }
      rename => { "client.user.business.unit" => "[client][user][business][unit]" }
      rename => { "client.user.domain" => "[client][user][domain]" }
      rename => { "client.user.email" => "[client][user][email]" }
      rename => { "client.user.full_name" => "[client][user][full_name]" }
      rename => { "client.user.full_name.text" => "[client][user][full_name][text]" }
      rename => { "client.user.geo.city_name" => "[client][user][geo][city_name]" }
      rename => { "client.user.geo.country_name" => "[client][user][geo][country_name]" }
      rename => { "client.user.geo.country_name" => "[client][user][geo][country_name]" }
      rename => { "client.user.geo.region_name" => "[client][user][geo][region_name]" }
      rename => { "client.user.group.domain" => "[client][user][group][domain]" }
      rename => { "client.user.group.id" => "[client][user][group][id]" }
      rename => { "client.user.group.name" => "[client][user][group][name]" }
      rename => { "client.user.hash" => "[client][user][hash]" }
      rename => { "client.user.id" => "[client][user][id]" }
      rename => { "client.user.name" => "[client][user][name]" }
      rename => { "client.user.name.text" => "[client][user][name][text]" }
      rename => { "client.user.roles" => "[client][user][roles]" }
      rename => { "client.user.title" => "[client][user][title]" }
      rename => { "cloud.account.id" => "[cloud][account][id]" }
      rename => { "cloud.account.name" => "[cloud][account][name]" }
      rename => { "cloud.availability_zone" => "[cloud][availability_zone]" }
      rename => { "cloud.instance.id" => "[cloud][instance][id]" }
      rename => { "cloud.instance.name" => "[cloud][instance][name]" }
      rename => { "cloud.machine.type" => "[cloud][machine][type]" }
      rename => { "cloud.project.id" => "[cloud][project][id]" }
      rename => { "cloud.project.name" => "[cloud][project][name]" }
      rename => { "cloud.provider" => "[cloud][provider]" }
      rename => { "cloud.region" => "[cloud][region]" }
      rename => { "cloud.service.name" => "[cloud][service][name]" }
      rename => { "container.id" => "[container][id]" }
      rename => { "container.image.name" => "[container][image][name]" }
      rename => { "container.image.tag" => "[container][image][tag]" }
      rename => { "container.labels" => "[container][labels]" }
      rename => { "container.name" => "[container][name]" }
      rename => { "container.runtime" => "[container][runtime]" }
      rename => { "database.field_names" => "[database][field_names]" }
      rename => { "database.instance" => "[database][instance]" }
      rename => { "database.name " => "[database][name ]" }
      rename => { "database.table" => "[database][table]" }
      rename => { "database.user.domain" => "[database][user][domain]" }
      rename => { "database.user.email" => "[database][user][email]" }
      rename => { "database.user.full_name" => "[database][user][full_name]" }
      rename => { "database.user.full_name.text" => "[database][user][full_name][text]" }
      rename => { "database.user.group.id" => "[database][user][group][id]" }
      rename => { "database.user.group.name" => "[database][user][group][name]" }
      rename => { "database.user.hash" => "[database][user][hash]" }
      rename => { "database.user.id" => "[database][user][id]" }
      rename => { "database.user.name" => "[database][user][name]" }
      rename => { "database.user.name.text" => "[database][user][name][text]" }
      rename => { "destination.address" => "[destination][address]" }
      rename => { "destination.as.number" => "[destination][as][number]" }
      rename => { "destination.as.organization.name" => "[destination][as][organization][name]" }
      rename => { "destination.as.organization.name.text" => "[destination][as][organization][name][text]" }
      rename => { "destination.bytes" => "[destination][bytes]" }
      rename => { "destination.domain" => "[destination][domain]" }
      rename => { "destination.geo.city_name" => "[destination][geo][city_name]" }
      rename => { "destination.geo.continent_code" => "[destination][geo][continent_code]" }
      rename => { "destination.geo.continent_name" => "[destination][geo][continent_name]" }
      rename => { "destination.geo.country_iso_code" => "[destination][geo][country_iso_code]" }
      rename => { "destination.geo.country_name" => "[destination][geo][country_name]" }
      rename => { "destination.geo.location" => "[destination][geo][location]" }
      rename => { "destination.geo.name" => "[destination][geo][name]" }
      rename => { "destination.geo.postal_code" => "[destination][geo][postal_code]" }
      rename => { "destination.geo.region_iso_code" => "[destination][geo][region_iso_code]" }
      rename => { "destination.geo.region_name" => "[destination][geo][region_name]" }
      rename => { "destination.geo.timezone" => "[destination][geo][timezone]" }
      rename => { "destination.ip" => "[destination][ip]" }
      rename => { "destination.mac" => "[destination][mac]" }
      rename => { "destination.nat.ip" => "[destination][nat][ip]" }
      rename => { "destination.nat.port" => "[destination][nat][port]" }
      rename => { "destination.packets" => "[destination][packets]" }
      rename => { "destination.port" => "[destination][port]" }
      rename => { "destination.registered_domain" => "[destination][registered_domain]" }
      rename => { "destination.subdomain" => "[destination][subdomain]" }
      rename => { "destination.top_level_domain" => "[destination][top_level_domain]" }
      rename => { "destination.user.business.unit" => "[destination][user][business][unit]" }
      rename => { "destination.user.domain" => "[destination][user][domain]" }
      rename => { "destination.user.email" => "[destination][user][email]" }
      rename => { "destination.user.full_name" => "[destination][user][full_name]" }
      rename => { "destination.user.full_name.text" => "[destination][user][full_name][text]" }
      rename => { "destination.user.geo.city_name" => "[destination][user][geo][city_name]" }
      rename => { "destination.user.geo.country_name" => "[destination][user][geo][country_name]" }
      rename => { "destination.user.geo.country_name" => "[destination][user][geo][country_name]" }
      rename => { "destination.user.geo.region_name" => "[destination][user][geo][region_name]" }
      rename => { "destination.user.group.domain" => "[destination][user][group][domain]" }
      rename => { "destination.user.group.id" => "[destination][user][group][id]" }
      rename => { "destination.user.group.name" => "[destination][user][group][name]" }
      rename => { "destination.user.hash" => "[destination][user][hash]" }
      rename => { "destination.user.id" => "[destination][user][id]" }
      rename => { "destination.user.name" => "[destination][user][name]" }
      rename => { "destination.user.name.text" => "[destination][user][name][text]" }
      rename => { "destination.user.roles" => "[destination][user][roles]" }
      rename => { "destination.user.title" => "[destination][user][title]" }
      rename => { "dll.code_signature.exists" => "[dll][code_signature][exists]" }
      rename => { "dll.code_signature.signing_id" => "[dll][code_signature][signing_id]" }
      rename => { "dll.code_signature.status" => "[dll][code_signature][status]" }
      rename => { "dll.code_signature.subject_name" => "[dll][code_signature][subject_name]" }
      rename => { "dll.code_signature.team_id" => "[dll][code_signature][team_id]" }
      rename => { "dll.code_signature.trusted" => "[dll][code_signature][trusted]" }
      rename => { "dll.code_signature.valid" => "[dll][code_signature][valid]" }
      rename => { "dll.hash.md5" => "[dll][hash][md5]" }
      rename => { "dll.hash.sha1" => "[dll][hash][sha1]" }
      rename => { "dll.hash.sha256" => "[dll][hash][sha256]" }
      rename => { "dll.hash.sha512" => "[dll][hash][sha512]" }
      rename => { "dll.hash.ssdeep" => "[dll][hash][ssdeep]" }
      rename => { "dll.name" => "[dll][name]" }
      rename => { "dll.path" => "[dll][path]" }
      rename => { "dll.pe.architecture" => "[dll][pe][architecture]" }
      rename => { "dll.pe.company" => "[dll][pe][company]" }
      rename => { "dll.pe.description" => "[dll][pe][description]" }
      rename => { "dll.pe.file_version" => "[dll][pe][file_version]" }
      rename => { "dll.pe.imphash" => "[dll][pe][imphash]" }
      rename => { "dll.pe.original_file_name" => "[dll][pe][original_file_name]" }
      rename => { "dll.pe.product" => "[dll][pe][product]" }
      rename => { "dns.answers" => "[dns][answers]" }
      rename => { "dns.answers.class" => "[dns][answers][class]" }
      rename => { "dns.answers.data" => "[dns][answers][data]" }
      rename => { "dns.answers.name" => "[dns][answers][name]" }
      rename => { "dns.answers.ttl" => "[dns][answers][ttl]" }
      rename => { "dns.answers.type" => "[dns][answers][type]" }
      rename => { "dns.header_flags" => "[dns][header_flags]" }
      rename => { "dns.id" => "[dns][id]" }
      rename => { "dns.op_code" => "[dns][op_code]" }
      rename => { "dns.question.class" => "[dns][question][class]" }
      rename => { "dns.question.name" => "[dns][question][name]" }
      rename => { "dns.question.registered_domain" => "[dns][question][registered_domain]" }
      rename => { "dns.question.subdomain" => "[dns][question][subdomain]" }
      rename => { "dns.question.top_level_domain" => "[dns][question][top_level_domain]" }
      rename => { "dns.question.type" => "[dns][question][type]" }
      rename => { "dns.resolved_ip" => "[dns][resolved_ip]" }
      rename => { "dns.response_code" => "[dns][response_code]" }
      rename => { "dns.type" => "[dns][type]" }
      rename => { "ecs.version" => "[ecs][version]" }
      rename => { "email.body" => "[email][body]" }
      rename => { "email.header" => "[email][header]" }
      rename => { "email.reply_to " => "[email][reply_to ]" }
      rename => { "email.src_display_name " => "[email][src_display_name ]" }
      rename => { "email.subject" => "[email][subject]" }
      rename => { "email.x_mailer" => "[email][x_mailer]" }
      rename => { "error.code" => "[error][code]" }
      rename => { "error.id" => "[error][id]" }
      rename => { "error.message" => "[error][message]" }
      rename => { "error.stack_trace" => "[error][stack_trace]" }
      rename => { "error.stack_trace.text" => "[error][stack_trace][text]" }
      rename => { "error.type" => "[error][type]" }
      rename => { "event.action" => "[event][action]" }
      rename => { "event.category" => "[event][category]" }
      rename => { "event.code" => "[event][code]" }
      rename => { "event.created" => "[event][created]" }
      rename => { "event.dataset" => "[event][dataset]" }
      rename => { "event.duration" => "[event][duration]" }
      rename => { "event.end" => "[event][end]" }
      rename => { "event.hash" => "[event][hash]" }
      rename => { "event.id" => "[event][id]" }
      rename => { "event.ingested" => "[event][ingested]" }
      rename => { "event.kind" => "[event][kind]" }
      rename => { "event.modified" => "[event][modified]" }
      rename => { "event.module" => "[event][module]" }
      rename => { "event.original" => "[event][original]" }
      rename => { "event.outcome" => "[event][outcome]" }
      rename => { "event.provider" => "[event][provider]" }
      rename => { "event.reason" => "[event][reason]" }
      rename => { "event.recommendation" => "[event][recommendation]" }
      rename => { "event.reference" => "[event][reference]" }
      rename => { "event.risk_score" => "[event][risk_score]" }
      rename => { "event.risk_score_norm" => "[event][risk_score_norm]" }
      rename => { "event.sequence" => "[event][sequence]" }
      rename => { "event.severity" => "[event][severity]" }
      rename => { "event.severity_name" => "[event][severity_name]" }
      rename => { "event.start" => "[event][start]" }
      rename => { "event.timezone" => "[event][timezone]" }
      rename => { "event.type" => "[event][type]" }
      rename => { "event.url" => "[event][url]" }
      rename => { "file.accessed" => "[file][accessed]" }
      rename => { "file.attributes" => "[file][attributes]" }
      rename => { "file.code_signature.exists" => "[file][code_signature][exists]" }
      rename => { "file.code_signature.signing_id" => "[file][code_signature][signing_id]" }
      rename => { "file.code_signature.status" => "[file][code_signature][status]" }
      rename => { "file.code_signature.subject_name" => "[file][code_signature][subject_name]" }
      rename => { "file.code_signature.team_id" => "[file][code_signature][team_id]" }
      rename => { "file.code_signature.trusted" => "[file][code_signature][trusted]" }
      rename => { "file.code_signature.valid" => "[file][code_signature][valid]" }
      rename => { "file.created" => "[file][created]" }
      rename => { "file.ctime" => "[file][ctime]" }
      rename => { "file.device" => "[file][device]" }
      rename => { "file.directory" => "[file][directory]" }
      rename => { "file.drive_letter" => "[file][drive_letter]" }
      rename => { "file.extension" => "[file][extension]" }
      rename => { "file.gid" => "[file][gid]" }
      rename => { "file.group" => "[file][group]" }
      rename => { "file.hash.md5" => "[file][hash][md5]" }
      rename => { "file.hash.sha1" => "[file][hash][sha1]" }
      rename => { "file.hash.sha256" => "[file][hash][sha256]" }
      rename => { "file.hash.sha512" => "[file][hash][sha512]" }
      rename => { "file.hash.ssdeep" => "[file][hash][ssdeep]" }
      rename => { "file.inode" => "[file][inode]" }
      rename => { "file.mime_type" => "[file][mime_type]" }
      rename => { "file.mode" => "[file][mode]" }
      rename => { "file.mtime" => "[file][mtime]" }
      rename => { "file.name" => "[file][name]" }
      rename => { "file.owner" => "[file][owner]" }
      rename => { "file.path" => "[file][path]" }
      rename => { "file.path.text" => "[file][path][text]" }
      rename => { "file.pe.architecture" => "[file][pe][architecture]" }
      rename => { "file.pe.company" => "[file][pe][company]" }
      rename => { "file.pe.description" => "[file][pe][description]" }
      rename => { "file.pe.file_version" => "[file][pe][file_version]" }
      rename => { "file.pe.imphash" => "[file][pe][imphash]" }
      rename => { "file.pe.original_file_name" => "[file][pe][original_file_name]" }
      rename => { "file.pe.product" => "[file][pe][product]" }
      rename => { "file.size" => "[file][size]" }
      rename => { "file.target_path" => "[file][target_path]" }
      rename => { "file.target_path.text" => "[file][target_path][text]" }
      rename => { "file.type" => "[file][type]" }
      rename => { "file.uid" => "[file][uid]" }
      rename => { "file.x509.alternative_names" => "[file][x509][alternative_names]" }
      rename => { "file.x509.issuer.common_name" => "[file][x509][issuer][common_name]" }
      rename => { "file.x509.issuer.country" => "[file][x509][issuer][country]" }
      rename => { "file.x509.issuer.distinguished_name" => "[file][x509][issuer][distinguished_name]" }
      rename => { "file.x509.issuer.locality" => "[file][x509][issuer][locality]" }
      rename => { "file.x509.issuer.organization" => "[file][x509][issuer][organization]" }
      rename => { "file.x509.issuer.organizational_unit" => "[file][x509][issuer][organizational_unit]" }
      rename => { "file.x509.issuer.state_or_province" => "[file][x509][issuer][state_or_province]" }
      rename => { "file.x509.not_after" => "[file][x509][not_after]" }
      rename => { "file.x509.not_before" => "[file][x509][not_before]" }
      rename => { "file.x509.public_key_algorithm" => "[file][x509][public_key_algorithm]" }
      rename => { "file.x509.public_key_curve" => "[file][x509][public_key_curve]" }
      rename => { "file.x509.public_key_exponent" => "[file][x509][public_key_exponent]" }
      rename => { "file.x509.public_key_size" => "[file][x509][public_key_size]" }
      rename => { "file.x509.serial_number" => "[file][x509][serial_number]" }
      rename => { "file.x509.signature_algorithm" => "[file][x509][signature_algorithm]" }
      rename => { "file.x509.subject.common_name" => "[file][x509][subject][common_name]" }
      rename => { "file.x509.subject.country" => "[file][x509][subject][country]" }
      rename => { "file.x509.subject.distinguished_name" => "[file][x509][subject][distinguished_name]" }
      rename => { "file.x509.subject.locality" => "[file][x509][subject][locality]" }
      rename => { "file.x509.subject.organization" => "[file][x509][subject][organization]" }
      rename => { "file.x509.subject.organizational_unit" => "[file][x509][subject][organizational_unit]" }
      rename => { "file.x509.subject.state_or_province" => "[file][x509][subject][state_or_province]" }
      rename => { "file.x509.version_number" => "[file][x509][version_number]" }
      rename => { "group.domain" => "[group][domain]" }
      rename => { "group.id" => "[group][id]" }
      rename => { "group.name" => "[group][name]" }
      rename => { "host.architecture" => "[host][architecture]" }
      rename => { "host.business" => "[host][business]" }
      rename => { "host.cpu.usage" => "[host][cpu][usage]" }
      rename => { "host.disk.read.bytes" => "[host][disk][read][bytes]" }
      rename => { "host.disk.write.bytes" => "[host][disk][write][bytes]" }
      rename => { "host.domain" => "[host][domain]" }
      rename => { "host.geo.city_name" => "[host][geo][city_name]" }
      rename => { "host.geo.continent_code" => "[host][geo][continent_code]" }
      rename => { "host.geo.continent_name" => "[host][geo][continent_name]" }
      rename => { "host.geo.country_iso_code" => "[host][geo][country_iso_code]" }
      rename => { "host.geo.country_name" => "[host][geo][country_name]" }
      rename => { "host.geo.location" => "[host][geo][location]" }
      rename => { "host.geo.name" => "[host][geo][name]" }
      rename => { "host.geo.postal_code" => "[host][geo][postal_code]" }
      rename => { "host.geo.region_iso_code" => "[host][geo][region_iso_code]" }
      rename => { "host.geo.region_name" => "[host][geo][region_name]" }
      rename => { "host.geo.timezone" => "[host][geo][timezone]" }
      rename => { "host.hostname" => "[host][hostname]" }
      rename => { "host.id" => "[host][id]" }
      rename => { "host.ip" => "[host][ip]" }
      rename => { "host.last_logged_in_user" => "[host][last_logged_in_user]" }
      rename => { "host.logged_in_users" => "[host][logged_in_users]" }
      rename => { "host.mac" => "[host][mac]" }
      rename => { "host.manufacturer" => "[host][manufacturer]" }
      rename => { "host.model" => "[host][model]" }
      rename => { "host.name" => "[host][name]" }
      rename => { "host.network.egress.bytes" => "[host][network][egress][bytes]" }
      rename => { "host.network.egress.packets" => "[host][network][egress][packets]" }
      rename => { "host.network.ingress.bytes" => "[host][network][ingress][bytes]" }
      rename => { "host.network.ingress.packets" => "[host][network][ingress][packets]" }
      rename => { "host.os.family" => "[host][os][family]" }
      rename => { "host.os.full" => "[host][os][full]" }
      rename => { "host.os.full.text" => "[host][os][full][text]" }
      rename => { "host.os.installation_date" => "[host][os][installation_date]" }
      rename => { "host.os.kernel" => "[host][os][kernel]" }
      rename => { "host.os.name" => "[host][os][name]" }
      rename => { "host.os.name.text" => "[host][os][name][text]" }
      rename => { "host.os.platform" => "[host][os][platform]" }
      rename => { "host.os.type" => "[host][os][type]" }
      rename => { "host.os.version" => "[host][os][version]" }
      rename => { "host.serial" => "[host][serial]" }
      rename => { "host.timezone" => "[host][timezone]" }
      rename => { "host.type" => "[host][type]" }
      rename => { "host.uptime" => "[host][uptime]" }
      rename => { "host.user.business.unit" => "[host][user][business][unit]" }
      rename => { "host.user.department" => "[host][user][department]" }
      rename => { "host.user.domain" => "[host][user][domain]" }
      rename => { "host.user.email" => "[host][user][email]" }
      rename => { "host.user.full_name" => "[host][user][full_name]" }
      rename => { "host.user.full_name.text" => "[host][user][full_name][text]" }
      rename => { "host.user.geo.country_name" => "[host][user][geo][country_name]" }
      rename => { "host.user.geo.country_name" => "[host][user][geo][country_name]" }
      rename => { "host.user.geo.region_name" => "[host][user][geo][region_name]" }
      rename => { "host.user.group.domain" => "[host][user][group][domain]" }
      rename => { "host.user.group.id" => "[host][user][group][id]" }
      rename => { "host.user.group.name" => "[host][user][group][name]" }
      rename => { "host.user.hash" => "[host][user][hash]" }
      rename => { "host.user.id" => "[host][user][id]" }
      rename => { "host.user.manager_email" => "[host][user][manager_email]" }
      rename => { "host.user.manager_name" => "[host][user][manager_name]" }
      rename => { "host.user.name" => "[host][user][name]" }
      rename => { "host.user.name.text" => "[host][user][name][text]" }
      rename => { "host.user.roles" => "[host][user][roles]" }
      rename => { "host.user.title" => "[host][user][title]" }
      rename => { "http.cookie.name" => "[http][cookie][name]" }
      rename => { "http.request.body.bytes" => "[http][request][body][bytes]" }
      rename => { "http.request.body.content" => "[http][request][body][content]" }
      rename => { "http.request.body.content.text" => "[http][request][body][content][text]" }
      rename => { "http.request.bytes" => "[http][request][bytes]" }
      rename => { "http.request.id" => "[http][request][id]" }
      rename => { "http.request.method" => "[http][request][method]" }
      rename => { "http.request.mime_type" => "[http][request][mime_type]" }
      rename => { "http.request.referrer" => "[http][request][referrer]" }
      rename => { "http.response.body.bytes" => "[http][response][body][bytes]" }
      rename => { "http.response.body.content" => "[http][response][body][content]" }
      rename => { "http.response.body.content.text" => "[http][response][body][content][text]" }
      rename => { "http.response.bytes" => "[http][response][bytes]" }
      rename => { "http.response.mime_type" => "[http][response][mime_type]" }
      rename => { "http.response.status_code" => "[http][response][status_code]" }
      rename => { "http.version" => "[http][version]" }
      rename => { "kafka.offset" => "[kafka][offset]" }
      rename => { "kafka.partition" => "[kafka][partition]" }
      rename => { "kafka.timestamp" => "[kafka][timestamp]" }
      rename => { "kafka.topic" => "[kafka][topic]" }
      rename => { "labels" => "[labels]" }
      rename => { "log.file.path" => "[log][file][path]" }
      rename => { "log.level" => "[log][level]" }
      rename => { "log.logger" => "[log][logger]" }
      rename => { "log.origin.file.line" => "[log][origin][file][line]" }
      rename => { "log.origin.file.name" => "[log][origin][file][name]" }
      rename => { "log.origin.function" => "[log][origin][function]" }
      rename => { "log.original" => "[log][original]" }
      rename => { "log.source.hostname" => "[log][source][hostname]" }
      rename => { "log.source.ip" => "[log][source][ip]" }
      rename => { "log.syslog" => "[log][syslog]" }
      rename => { "log.syslog.facility.code" => "[log][syslog][facility][code]" }
      rename => { "log.syslog.facility.name" => "[log][syslog][facility][name]" }
      rename => { "log.syslog.priority" => "[log][syslog][priority]" }
      rename => { "log.syslog.severity.code" => "[log][syslog][severity][code]" }
      rename => { "log.syslog.severity.name" => "[log][syslog][severity][name]" }
      rename => { "message" => "[message]" }
      rename => { "network.application" => "[network][application]" }
      rename => { "network.bytes" => "[network][bytes]" }
      rename => { "network.community_id" => "[network][community_id]" }
      rename => { "network.description" => "[network][description]" }
      rename => { "network.direction" => "[network][direction]" }
      rename => { "network.dmz" => "[network][dmz]" }
      rename => { "network.forwarded_ip" => "[network][forwarded_ip]" }
      rename => { "network.geo.bu" => "[network][geo][bu]" }
      rename => { "network.geo.city_name" => "[network][geo][city_name]" }
      rename => { "network.geo.continent_code" => "[network][geo][continent_code]" }
      rename => { "network.geo.continent_name" => "[network][geo][continent_name]" }
      rename => { "network.geo.country_iso_code" => "[network][geo][country_iso_code]" }
      rename => { "network.geo.country_name" => "[network][geo][country_name]" }
      rename => { "network.geo.location" => "[network][geo][location]" }
      rename => { "network.geo.name" => "[network][geo][name]" }
      rename => { "network.geo.postal_code" => "[network][geo][postal_code]" }
      rename => { "network.geo.region_iso_code" => "[network][geo][region_iso_code]" }
      rename => { "network.geo.region_name" => "[network][geo][region_name]" }
      rename => { "network.geo.site_id" => "[network][geo][site_id]" }
      rename => { "network.geo.street_address" => "[network][geo][street_address]" }
      rename => { "network.geo.timezone" => "[network][geo][timezone]" }
      rename => { "network.iana_number" => "[network][iana_number]" }
      rename => { "network.inner" => "[network][inner]" }
      rename => { "network.inner.vlan.id" => "[network][inner][vlan][id]" }
      rename => { "network.inner.vlan.name" => "[network][inner][vlan][name]" }
      rename => { "network.mac" => "[network][mac]" }
      rename => { "network.name" => "[network][name]" }
      rename => { "network.network_range" => "[network][network_range]" }
      rename => { "network.packets" => "[network][packets]" }
      rename => { "network.plant_system_control" => "[network][plant_system_control]" }
      rename => { "network.protocol" => "[network][protocol]" }
      rename => { "network.transport" => "[network][transport]" }
      rename => { "network.type" => "[network][type]" }
      rename => { "network.vlan.id" => "[network][vlan][id]" }
      rename => { "network.vlan.name" => "[network][vlan][name]" }
      rename => { "observer.egress" => "[observer][egress]" }
      rename => { "observer.egress.interface.alias" => "[observer][egress][interface][alias]" }
      rename => { "observer.egress.interface.id" => "[observer][egress][interface][id]" }
      rename => { "observer.egress.interface.name" => "[observer][egress][interface][name]" }
      rename => { "observer.egress.ip" => "[observer][egress][ip]" }
      rename => { "observer.egress.vlan.id" => "[observer][egress][vlan][id]" }
      rename => { "observer.egress.vlan.name" => "[observer][egress][vlan][name]" }
      rename => { "observer.egress.zone" => "[observer][egress][zone]" }
      rename => { "observer.geo.city_name" => "[observer][geo][city_name]" }
      rename => { "observer.geo.continent_code" => "[observer][geo][continent_code]" }
      rename => { "observer.geo.continent_name" => "[observer][geo][continent_name]" }
      rename => { "observer.geo.country_iso_code" => "[observer][geo][country_iso_code]" }
      rename => { "observer.geo.country_name" => "[observer][geo][country_name]" }
      rename => { "observer.geo.location" => "[observer][geo][location]" }
      rename => { "observer.geo.name" => "[observer][geo][name]" }
      rename => { "observer.geo.postal_code" => "[observer][geo][postal_code]" }
      rename => { "observer.geo.region_iso_code" => "[observer][geo][region_iso_code]" }
      rename => { "observer.geo.region_name" => "[observer][geo][region_name]" }
      rename => { "observer.geo.timezone" => "[observer][geo][timezone]" }
      rename => { "observer.hostname" => "[observer][hostname]" }
      rename => { "observer.ingress" => "[observer][ingress]" }
      rename => { "observer.ingress.interface.alias" => "[observer][ingress][interface][alias]" }
      rename => { "observer.ingress.interface.host_count" => "[observer][ingress][interface][host_count]" }
      rename => { "observer.ingress.interface.id" => "[observer][ingress][interface][id]" }
      rename => { "observer.ingress.interface.name" => "[observer][ingress][interface][name]" }
      rename => { "observer.ingress.ip" => "[observer][ingress][ip]" }
      rename => { "observer.ingress.vlan.id" => "[observer][ingress][vlan][id]" }
      rename => { "observer.ingress.vlan.name" => "[observer][ingress][vlan][name]" }
      rename => { "observer.ingress.zone" => "[observer][ingress][zone]" }
      rename => { "observer.ip" => "[observer][ip]" }
      rename => { "observer.mac" => "[observer][mac]" }
      rename => { "observer.name" => "[observer][name]" }
      rename => { "observer.os.family" => "[observer][os][family]" }
      rename => { "observer.os.full" => "[observer][os][full]" }
      rename => { "observer.os.full.text" => "[observer][os][full][text]" }
      rename => { "observer.os.kernel" => "[observer][os][kernel]" }
      rename => { "observer.os.name" => "[observer][os][name]" }
      rename => { "observer.os.name.text" => "[observer][os][name][text]" }
      rename => { "observer.os.platform" => "[observer][os][platform]" }
      rename => { "observer.os.type" => "[observer][os][type]" }
      rename => { "observer.os.version" => "[observer][os][version]" }
      rename => { "observer.product" => "[observer][product]" }
      rename => { "observer.serial_number" => "[observer][serial_number]" }
      rename => { "observer.type" => "[observer][type]" }
      rename => { "observer.vendor" => "[observer][vendor]" }
      rename => { "observer.version" => "[observer][version]" }
      rename => { "organization.id" => "[organization][id]" }
      rename => { "organization.name" => "[organization][name]" }
      rename => { "organization.name.text" => "[organization][name][text]" }
      rename => { "package.architecture" => "[package][architecture]" }
      rename => { "package.build_version" => "[package][build_version]" }
      rename => { "package.checksum" => "[package][checksum]" }
      rename => { "package.description" => "[package][description]" }
      rename => { "package.install_scope" => "[package][install_scope]" }
      rename => { "package.installed" => "[package][installed]" }
      rename => { "package.license" => "[package][license]" }
      rename => { "package.name" => "[package][name]" }
      rename => { "package.path" => "[package][path]" }
      rename => { "package.reference" => "[package][reference]" }
      rename => { "package.size" => "[package][size]" }
      rename => { "package.type" => "[package][type]" }
      rename => { "package.version" => "[package][version]" }
      rename => { "process.args" => "[process][args]" }
      rename => { "process.args_count" => "[process][args_count]" }
      rename => { "process.code_signature.exists" => "[process][code_signature][exists]" }
      rename => { "process.code_signature.signing_id" => "[process][code_signature][signing_id]" }
      rename => { "process.code_signature.status" => "[process][code_signature][status]" }
      rename => { "process.code_signature.subject_name" => "[process][code_signature][subject_name]" }
      rename => { "process.code_signature.team_id" => "[process][code_signature][team_id]" }
      rename => { "process.code_signature.trusted" => "[process][code_signature][trusted]" }
      rename => { "process.code_signature.valid" => "[process][code_signature][valid]" }
      rename => { "process.command_line" => "[process][command_line]" }
      rename => { "process.command_line.text" => "[process][command_line][text]" }
      rename => { "process.entity_id" => "[process][entity_id]" }
      rename => { "process.executable" => "[process][executable]" }
      rename => { "process.executable.text" => "[process][executable][text]" }
      rename => { "process.exit_code" => "[process][exit_code]" }
      rename => { "process.hash.md5" => "[process][hash][md5]" }
      rename => { "process.hash.sha1" => "[process][hash][sha1]" }
      rename => { "process.hash.sha256" => "[process][hash][sha256]" }
      rename => { "process.hash.sha512" => "[process][hash][sha512]" }
      rename => { "process.hash.ssdeep" => "[process][hash][ssdeep]" }
      rename => { "process.name" => "[process][name]" }
      rename => { "process.name.text" => "[process][name][text]" }
      rename => { "process.parent.args" => "[process][parent][args]" }
      rename => { "process.parent.args_count" => "[process][parent][args_count]" }
      rename => { "process.parent.code_signature.exists" => "[process][parent][code_signature][exists]" }
      rename => { "process.parent.code_signature.signing_id" => "[process][parent][code_signature][signing_id]" }
      rename => { "process.parent.code_signature.status" => "[process][parent][code_signature][status]" }
      rename => { "process.parent.code_signature.subject_name" => "[process][parent][code_signature][subject_name]" }
      rename => { "process.parent.code_signature.team_id" => "[process][parent][code_signature][team_id]" }
      rename => { "process.parent.code_signature.trusted" => "[process][parent][code_signature][trusted]" }
      rename => { "process.parent.code_signature.valid" => "[process][parent][code_signature][valid]" }
      rename => { "process.parent.command_line" => "[process][parent][command_line]" }
      rename => { "process.parent.command_line.text" => "[process][parent][command_line][text]" }
      rename => { "process.parent.entity_id" => "[process][parent][entity_id]" }
      rename => { "process.parent.executable" => "[process][parent][executable]" }
      rename => { "process.parent.executable.text" => "[process][parent][executable][text]" }
      rename => { "process.parent.exit_code" => "[process][parent][exit_code]" }
      rename => { "process.parent.hash.md5" => "[process][parent][hash][md5]" }
      rename => { "process.parent.hash.sha1" => "[process][parent][hash][sha1]" }
      rename => { "process.parent.hash.sha256" => "[process][parent][hash][sha256]" }
      rename => { "process.parent.hash.sha512" => "[process][parent][hash][sha512]" }
      rename => { "process.parent.hash.ssdeep" => "[process][parent][hash][ssdeep]" }
      rename => { "process.parent.name" => "[process][parent][name]" }
      rename => { "process.parent.name.text" => "[process][parent][name][text]" }
      rename => { "process.parent.pe.architecture" => "[process][parent][pe][architecture]" }
      rename => { "process.parent.pe.company" => "[process][parent][pe][company]" }
      rename => { "process.parent.pe.description" => "[process][parent][pe][description]" }
      rename => { "process.parent.pe.file_version" => "[process][parent][pe][file_version]" }
      rename => { "process.parent.pe.imphash" => "[process][parent][pe][imphash]" }
      rename => { "process.parent.pe.original_file_name" => "[process][parent][pe][original_file_name]" }
      rename => { "process.parent.pe.product" => "[process][parent][pe][product]" }
      rename => { "process.parent.pgid" => "[process][parent][pgid]" }
      rename => { "process.parent.pid" => "[process][parent][pid]" }
      rename => { "process.parent.ppid" => "[process][parent][ppid]" }
      rename => { "process.parent.start" => "[process][parent][start]" }
      rename => { "process.parent.thread.id" => "[process][parent][thread][id]" }
      rename => { "process.parent.thread.name" => "[process][parent][thread][name]" }
      rename => { "process.parent.title" => "[process][parent][title]" }
      rename => { "process.parent.title.text" => "[process][parent][title][text]" }
      rename => { "process.parent.uptime" => "[process][parent][uptime]" }
      rename => { "process.parent.working_directory" => "[process][parent][working_directory]" }
      rename => { "process.parent.working_directory.text" => "[process][parent][working_directory][text]" }
      rename => { "process.pe.architecture" => "[process][pe][architecture]" }
      rename => { "process.pe.company" => "[process][pe][company]" }
      rename => { "process.pe.description" => "[process][pe][description]" }
      rename => { "process.pe.file_version" => "[process][pe][file_version]" }
      rename => { "process.pe.imphash" => "[process][pe][imphash]" }
      rename => { "process.pe.original_file_name" => "[process][pe][original_file_name]" }
      rename => { "process.pe.product" => "[process][pe][product]" }
      rename => { "process.pgid" => "[process][pgid]" }
      rename => { "process.pid" => "[process][pid]" }
      rename => { "process.ppid" => "[process][ppid]" }
      rename => { "process.start" => "[process][start]" }
      rename => { "process.thread.id" => "[process][thread][id]" }
      rename => { "process.thread.name" => "[process][thread][name]" }
      rename => { "process.title" => "[process][title]" }
      rename => { "process.title.text" => "[process][title][text]" }
      rename => { "process.uptime" => "[process][uptime]" }
      rename => { "process.working_directory" => "[process][working_directory]" }
      rename => { "process.working_directory.text" => "[process][working_directory][text]" }
      rename => { "registry.data.bytes" => "[registry][data][bytes]" }
      rename => { "registry.data.strings" => "[registry][data][strings]" }
      rename => { "registry.data.type" => "[registry][data][type]" }
      rename => { "registry.hive" => "[registry][hive]" }
      rename => { "registry.key" => "[registry][key]" }
      rename => { "registry.path" => "[registry][path]" }
      rename => { "registry.value" => "[registry][value]" }
      rename => { "related.hash" => "[related][hash]" }
      rename => { "related.hosts" => "[related][hosts]" }
      rename => { "related.ip" => "[related][ip]" }
      rename => { "related.mac" => "[related][mac]" }
      rename => { "related.user" => "[related][user]" }
      rename => { "repository.name" => "[repository][name]" }
      rename => { "repository.visible" => "[repository][visible]" }
      rename => { "rule.author" => "[rule][author]" }
      rename => { "rule.category" => "[rule][category]" }
      rename => { "rule.description" => "[rule][description]" }
      rename => { "rule.id" => "[rule][id]" }
      rename => { "rule.license" => "[rule][license]" }
      rename => { "rule.name" => "[rule][name]" }
      rename => { "rule.reference" => "[rule][reference]" }
      rename => { "rule.ruleset" => "[rule][ruleset]" }
      rename => { "rule.uuid" => "[rule][uuid]" }
      rename => { "rule.version" => "[rule][version]" }
      rename => { "server.address" => "[server][address]" }
      rename => { "server.as.number" => "[server][as][number]" }
      rename => { "server.as.organization.name" => "[server][as][organization][name]" }
      rename => { "server.as.organization.name.text" => "[server][as][organization][name][text]" }
      rename => { "server.bytes" => "[server][bytes]" }
      rename => { "server.domain" => "[server][domain]" }
      rename => { "server.geo.city_name" => "[server][geo][city_name]" }
      rename => { "server.geo.continent_code" => "[server][geo][continent_code]" }
      rename => { "server.geo.continent_name" => "[server][geo][continent_name]" }
      rename => { "server.geo.country_iso_code" => "[server][geo][country_iso_code]" }
      rename => { "server.geo.country_name" => "[server][geo][country_name]" }
      rename => { "server.geo.location" => "[server][geo][location]" }
      rename => { "server.geo.name" => "[server][geo][name]" }
      rename => { "server.geo.postal_code" => "[server][geo][postal_code]" }
      rename => { "server.geo.region_iso_code" => "[server][geo][region_iso_code]" }
      rename => { "server.geo.region_name" => "[server][geo][region_name]" }
      rename => { "server.geo.timezone" => "[server][geo][timezone]" }
      rename => { "server.ip" => "[server][ip]" }
      rename => { "server.mac" => "[server][mac]" }
      rename => { "server.nat.ip" => "[server][nat][ip]" }
      rename => { "server.nat.port" => "[server][nat][port]" }
      rename => { "server.packets" => "[server][packets]" }
      rename => { "server.port" => "[server][port]" }
      rename => { "server.registered_domain" => "[server][registered_domain]" }
      rename => { "server.subdomain" => "[server][subdomain]" }
      rename => { "server.top_level_domain" => "[server][top_level_domain]" }
      rename => { "server.user.business.unit" => "[server][user][business][unit]" }
      rename => { "server.user.domain" => "[server][user][domain]" }
      rename => { "server.user.email" => "[server][user][email]" }
      rename => { "server.user.full_name" => "[server][user][full_name]" }
      rename => { "server.user.full_name.text" => "[server][user][full_name][text]" }
      rename => { "server.user.geo.city_name" => "[server][user][geo][city_name]" }
      rename => { "server.user.geo.country_name" => "[server][user][geo][country_name]" }
      rename => { "server.user.geo.country_name" => "[server][user][geo][country_name]" }
      rename => { "server.user.geo.region_name" => "[server][user][geo][region_name]" }
      rename => { "server.user.group.domain" => "[server][user][group][domain]" }
      rename => { "server.user.group.id" => "[server][user][group][id]" }
      rename => { "server.user.group.name" => "[server][user][group][name]" }
      rename => { "server.user.hash" => "[server][user][hash]" }
      rename => { "server.user.id" => "[server][user][id]" }
      rename => { "server.user.name" => "[server][user][name]" }
      rename => { "server.user.name.text" => "[server][user][name][text]" }
      rename => { "server.user.roles" => "[server][user][roles]" }
      rename => { "server.user.title" => "[server][user][title]" }
      rename => { "service.ephemeral_id" => "[service][ephemeral_id]" }
      rename => { "service.id" => "[service][id]" }
      rename => { "service.name" => "[service][name]" }
      rename => { "service.node.name" => "[service][node][name]" }
      rename => { "service.state" => "[service][state]" }
      rename => { "service.type" => "[service][type]" }
      rename => { "service.version" => "[service][version]" }
      rename => { "source.address" => "[source][address]" }
      rename => { "source.as.number" => "[source][as][number]" }
      rename => { "source.as.organization.name" => "[source][as][organization][name]" }
      rename => { "source.as.organization.name.text" => "[source][as][organization][name][text]" }
      rename => { "source.bytes" => "[source][bytes]" }
      rename => { "source.domain" => "[source][domain]" }
      rename => { "source.geo.city_name" => "[source][geo][city_name]" }
      rename => { "source.geo.continent_code" => "[source][geo][continent_code]" }
      rename => { "source.geo.continent_name" => "[source][geo][continent_name]" }
      rename => { "source.geo.country_iso_code" => "[source][geo][country_iso_code]" }
      rename => { "source.geo.country_name" => "[source][geo][country_name]" }
      rename => { "source.geo.location" => "[source][geo][location]" }
      rename => { "source.geo.name" => "[source][geo][name]" }
      rename => { "source.geo.postal_code" => "[source][geo][postal_code]" }
      rename => { "source.geo.region_iso_code" => "[source][geo][region_iso_code]" }
      rename => { "source.geo.region_name" => "[source][geo][region_name]" }
      rename => { "source.geo.timezone" => "[source][geo][timezone]" }
      rename => { "source.ip" => "[source][ip]" }
      rename => { "source.mac" => "[source][mac]" }
      rename => { "source.nat.ip" => "[source][nat][ip]" }
      rename => { "source.nat.port" => "[source][nat][port]" }
      rename => { "source.packets" => "[source][packets]" }
      rename => { "source.port" => "[source][port]" }
      rename => { "source.registered_domain" => "[source][registered_domain]" }
      rename => { "source.subdomain" => "[source][subdomain]" }
      rename => { "source.top_level_domain" => "[source][top_level_domain]" }
      rename => { "source.user.business.unit" => "[source][user][business][unit]" }
      rename => { "source.user.domain" => "[source][user][domain]" }
      rename => { "source.user.email" => "[source][user][email]" }
      rename => { "source.user.full_name" => "[source][user][full_name]" }
      rename => { "source.user.full_name.text" => "[source][user][full_name][text]" }
      rename => { "source.user.geo.city_name" => "[source][user][geo][city_name]" }
      rename => { "source.user.geo.country_name" => "[source][user][geo][country_name]" }
      rename => { "source.user.geo.country_name" => "[source][user][geo][country_name]" }
      rename => { "source.user.geo.region_name" => "[source][user][geo][region_name]" }
      rename => { "source.user.group.domain" => "[source][user][group][domain]" }
      rename => { "source.user.group.id" => "[source][user][group][id]" }
      rename => { "source.user.group.name" => "[source][user][group][name]" }
      rename => { "source.user.hash" => "[source][user][hash]" }
      rename => { "source.user.id" => "[source][user][id]" }
      rename => { "source.user.name" => "[source][user][name]" }
      rename => { "source.user.name.text" => "[source][user][name][text]" }
      rename => { "source.user.roles" => "[source][user][roles]" }
      rename => { "source.user.title" => "[source][user][title]" }
      rename => { "span.id" => "[span][id]" }
      rename => { "tags" => "[tags]" }
      rename => { "team.email" => "[team][email]" }
      rename => { "team.name" => "[team][name]" }
      rename => { "team.contact" => "[team][contact]" }
      rename => { "threat.framework" => "[threat][framework]" }
      rename => { "threat.list.attribute_tag" => "[threat][list][attribute_tag]" }
      rename => { "threat.list.category" => "[threat][list][category]" }
      rename => { "threat.list.comment" => "[threat][list][comment]" }
      rename => { "threat.list.created" => "[threat][list][created]" }
      rename => { "threat.list.distribution" => "[threat][list][distribution]" }
      rename => { "threat.list.event_analysis" => "[threat][list][event_analysis]" }
      rename => { "threat.list.event_id" => "[threat][list][event_id]" }
      rename => { "threat.list.event_info" => "[threat][list][event_info]" }
      rename => { "threat.list.event_tag" => "[threat][list][event_tag]" }
      rename => { "threat.list.injested" => "[threat][list][injested]" }
      rename => { "threat.list.ioc" => "[threat][list][ioc]" }
      rename => { "threat.list.member_org" => "[threat][list][member_org]" }
      rename => { "threat.list.object_category" => "[threat][list][object_category]" }
      rename => { "threat.list.object_name" => "[threat][list][object_name]" }
      rename => { "threat.list.object_relation" => "[threat][list][object_relation]" }
      rename => { "threat.list.object_uuid" => "[threat][list][object_uuid]" }
      rename => { "threat.list.safe_to_enable_ids" => "[threat][list][safe_to_enable_ids]" }
      rename => { "threat.list.severity_name" => "[threat][list][severity_name]" }
      rename => { "threat.list.source_org" => "[threat][list][source_org]" }
      rename => { "threat.list.start" => "[threat][list][start]" }
      rename => { "threat.list.type" => "[threat][list][type]" }
      rename => { "threat.list.type" => "[threat][list][type]" }
      rename => { "threat.list.uuid" => "[threat][list][uuid]" }
      rename => { "threat.tactic.id" => "[threat][tactic][id]" }
      rename => { "threat.tactic.name" => "[threat][tactic][name]" }
      rename => { "threat.tactic.reference" => "[threat][tactic][reference]" }
      rename => { "threat.technique.id" => "[threat][technique][id]" }
      rename => { "threat.technique.name" => "[threat][technique][name]" }
      rename => { "threat.technique.name.text" => "[threat][technique][name][text]" }
      rename => { "threat.technique.reference" => "[threat][technique][reference]" }
      rename => { "threat.technique.subtechnique.id" => "[threat][technique][subtechnique][id]" }
      rename => { "threat.technique.subtechnique.name" => "[threat][technique][subtechnique][name]" }
      rename => { "threat.technique.subtechnique.name.text" => "[threat][technique][subtechnique][name][text]" }
      rename => { "threat.technique.subtechnique.reference" => "[threat][technique][subtechnique][reference]" }
      rename => { "tls.cipher" => "[tls][cipher]" }
      rename => { "tls.client.certificate" => "[tls][client][certificate]" }
      rename => { "tls.client.certificate_chain" => "[tls][client][certificate_chain]" }
      rename => { "tls.client.hash.md5" => "[tls][client][hash][md5]" }
      rename => { "tls.client.hash.sha1" => "[tls][client][hash][sha1]" }
      rename => { "tls.client.hash.sha256" => "[tls][client][hash][sha256]" }
      rename => { "tls.client.issuer" => "[tls][client][issuer]" }
      rename => { "tls.client.ja3" => "[tls][client][ja3]" }
      rename => { "tls.client.not_after" => "[tls][client][not_after]" }
      rename => { "tls.client.not_before" => "[tls][client][not_before]" }
      rename => { "tls.client.server_name" => "[tls][client][server_name]" }
      rename => { "tls.client.subject" => "[tls][client][subject]" }
      rename => { "tls.client.supported_ciphers" => "[tls][client][supported_ciphers]" }
      rename => { "tls.client.x509.alternative_names" => "[tls][client][x509][alternative_names]" }
      rename => { "tls.client.x509.issuer.common_name" => "[tls][client][x509][issuer][common_name]" }
      rename => { "tls.client.x509.issuer.country" => "[tls][client][x509][issuer][country]" }
      rename => { "tls.client.x509.issuer.distinguished_name" => "[tls][client][x509][issuer][distinguished_name]" }
      rename => { "tls.client.x509.issuer.locality" => "[tls][client][x509][issuer][locality]" }
      rename => { "tls.client.x509.issuer.organization" => "[tls][client][x509][issuer][organization]" }
      rename => { "tls.client.x509.issuer.organizational_unit" => "[tls][client][x509][issuer][organizational_unit]" }
      rename => { "tls.client.x509.issuer.state_or_province" => "[tls][client][x509][issuer][state_or_province]" }
      rename => { "tls.client.x509.not_after" => "[tls][client][x509][not_after]" }
      rename => { "tls.client.x509.not_before" => "[tls][client][x509][not_before]" }
      rename => { "tls.client.x509.public_key_algorithm" => "[tls][client][x509][public_key_algorithm]" }
      rename => { "tls.client.x509.public_key_curve" => "[tls][client][x509][public_key_curve]" }
      rename => { "tls.client.x509.public_key_exponent" => "[tls][client][x509][public_key_exponent]" }
      rename => { "tls.client.x509.public_key_size" => "[tls][client][x509][public_key_size]" }
      rename => { "tls.client.x509.serial_number" => "[tls][client][x509][serial_number]" }
      rename => { "tls.client.x509.signature_algorithm" => "[tls][client][x509][signature_algorithm]" }
      rename => { "tls.client.x509.subject.common_name" => "[tls][client][x509][subject][common_name]" }
      rename => { "tls.client.x509.subject.country" => "[tls][client][x509][subject][country]" }
      rename => { "tls.client.x509.subject.distinguished_name" => "[tls][client][x509][subject][distinguished_name]" }
      rename => { "tls.client.x509.subject.locality" => "[tls][client][x509][subject][locality]" }
      rename => { "tls.client.x509.subject.organization" => "[tls][client][x509][subject][organization]" }
      rename => { "tls.client.x509.subject.organizational_unit" => "[tls][client][x509][subject][organizational_unit]" }
      rename => { "tls.client.x509.subject.state_or_province" => "[tls][client][x509][subject][state_or_province]" }
      rename => { "tls.client.x509.version_number" => "[tls][client][x509][version_number]" }
      rename => { "tls.curve" => "[tls][curve]" }
      rename => { "tls.established" => "[tls][established]" }
      rename => { "tls.next_protocol" => "[tls][next_protocol]" }
      rename => { "tls.resumed" => "[tls][resumed]" }
      rename => { "tls.server.certificate" => "[tls][server][certificate]" }
      rename => { "tls.server.certificate_chain" => "[tls][server][certificate_chain]" }
      rename => { "tls.server.hash.md5" => "[tls][server][hash][md5]" }
      rename => { "tls.server.hash.sha1" => "[tls][server][hash][sha1]" }
      rename => { "tls.server.hash.sha256" => "[tls][server][hash][sha256]" }
      rename => { "tls.server.issuer" => "[tls][server][issuer]" }
      rename => { "tls.server.ja3s" => "[tls][server][ja3s]" }
      rename => { "tls.server.not_after" => "[tls][server][not_after]" }
      rename => { "tls.server.not_before" => "[tls][server][not_before]" }
      rename => { "tls.server.subject" => "[tls][server][subject]" }
      rename => { "tls.server.x509.alternative_names" => "[tls][server][x509][alternative_names]" }
      rename => { "tls.server.x509.issuer.common_name" => "[tls][server][x509][issuer][common_name]" }
      rename => { "tls.server.x509.issuer.country" => "[tls][server][x509][issuer][country]" }
      rename => { "tls.server.x509.issuer.distinguished_name" => "[tls][server][x509][issuer][distinguished_name]" }
      rename => { "tls.server.x509.issuer.locality" => "[tls][server][x509][issuer][locality]" }
      rename => { "tls.server.x509.issuer.organization" => "[tls][server][x509][issuer][organization]" }
      rename => { "tls.server.x509.issuer.organizational_unit" => "[tls][server][x509][issuer][organizational_unit]" }
      rename => { "tls.server.x509.issuer.state_or_province" => "[tls][server][x509][issuer][state_or_province]" }
      rename => { "tls.server.x509.not_after" => "[tls][server][x509][not_after]" }
      rename => { "tls.server.x509.not_before" => "[tls][server][x509][not_before]" }
      rename => { "tls.server.x509.public_key_algorithm" => "[tls][server][x509][public_key_algorithm]" }
      rename => { "tls.server.x509.public_key_curve" => "[tls][server][x509][public_key_curve]" }
      rename => { "tls.server.x509.public_key_exponent" => "[tls][server][x509][public_key_exponent]" }
      rename => { "tls.server.x509.public_key_size" => "[tls][server][x509][public_key_size]" }
      rename => { "tls.server.x509.serial_number" => "[tls][server][x509][serial_number]" }
      rename => { "tls.server.x509.signature_algorithm" => "[tls][server][x509][signature_algorithm]" }
      rename => { "tls.server.x509.subject.common_name" => "[tls][server][x509][subject][common_name]" }
      rename => { "tls.server.x509.subject.country" => "[tls][server][x509][subject][country]" }
      rename => { "tls.server.x509.subject.distinguished_name" => "[tls][server][x509][subject][distinguished_name]" }
      rename => { "tls.server.x509.subject.locality" => "[tls][server][x509][subject][locality]" }
      rename => { "tls.server.x509.subject.organization" => "[tls][server][x509][subject][organization]" }
      rename => { "tls.server.x509.subject.organizational_unit" => "[tls][server][x509][subject][organizational_unit]" }
      rename => { "tls.server.x509.subject.state_or_province" => "[tls][server][x509][subject][state_or_province]" }
      rename => { "tls.server.x509.version_number" => "[tls][server][x509][version_number]" }
      rename => { "tls.version" => "[tls][version]" }
      rename => { "tls.version_protocol" => "[tls][version_protocol]" }
      rename => { "trace.id" => "[trace][id]" }
      rename => { "transaction.id" => "[transaction][id]" }
      rename => { "url.domain" => "[url][domain]" }
      rename => { "url.extension" => "[url][extension]" }
      rename => { "url.fragment" => "[url][fragment]" }
      rename => { "url.full" => "[url][full]" }
      rename => { "url.full.text" => "[url][full][text]" }
      rename => { "url.original" => "[url][original]" }
      rename => { "url.original.text" => "[url][original][text]" }
      rename => { "url.password" => "[url][password]" }
      rename => { "url.path" => "[url][path]" }
      rename => { "url.port" => "[url][port]" }
      rename => { "url.query" => "[url][query]" }
      rename => { "url.registered_domain" => "[url][registered_domain]" }
      rename => { "url.scheme" => "[url][scheme]" }
      rename => { "url.subdomain" => "[url][subdomain]" }
      rename => { "url.top_level_domain" => "[url][top_level_domain]" }
      rename => { "url.username" => "[url][username]" }
      rename => { "user.business.unit" => "[user][business][unit]" }
      rename => { "user.changes.domain" => "[user][changes][domain]" }
      rename => { "user.changes.email" => "[user][changes][email]" }
      rename => { "user.changes.full_name" => "[user][changes][full_name]" }
      rename => { "user.changes.full_name.text" => "[user][changes][full_name][text]" }
      rename => { "user.changes.group.domain" => "[user][changes][group][domain]" }
      rename => { "user.changes.group.id" => "[user][changes][group][id]" }
      rename => { "user.changes.group.name" => "[user][changes][group][name]" }
      rename => { "user.changes.hash" => "[user][changes][hash]" }
      rename => { "user.changes.id" => "[user][changes][id]" }
      rename => { "user.changes.name" => "[user][changes][name]" }
      rename => { "user.changes.name.text" => "[user][changes][name][text]" }
      rename => { "user.changes.roles" => "[user][changes][roles]" }
      rename => { "user.domain" => "[user][domain]" }
      rename => { "user.effective.domain" => "[user][effective][domain]" }
      rename => { "user.effective.email" => "[user][effective][email]" }
      rename => { "user.effective.full_name" => "[user][effective][full_name]" }
      rename => { "user.effective.full_name.text" => "[user][effective][full_name][text]" }
      rename => { "user.effective.group.domain" => "[user][effective][group][domain]" }
      rename => { "user.effective.group.id" => "[user][effective][group][id]" }
      rename => { "user.effective.group.name" => "[user][effective][group][name]" }
      rename => { "user.effective.hash" => "[user][effective][hash]" }
      rename => { "user.effective.id" => "[user][effective][id]" }
      rename => { "user.effective.name" => "[user][effective][name]" }
      rename => { "user.effective.name.text" => "[user][effective][name][text]" }
      rename => { "user.effective.roles" => "[user][effective][roles]" }
      rename => { "user.email" => "[user][email]" }
      rename => { "user.full_name" => "[user][full_name]" }
      rename => { "user.full_name.text" => "[user][full_name][text]" }
      rename => { "user.geo.city_name" => "[user][geo][city_name]" }
      rename => { "user.geo.country_name" => "[user][geo][country_name]" }
      rename => { "user.geo.country_name" => "[user][geo][country_name]" }
      rename => { "user.geo.region_name" => "[user][geo][region_name]" }
      rename => { "user.group.domain" => "[user][group][domain]" }
      rename => { "user.group.id" => "[user][group][id]" }
      rename => { "user.group.name" => "[user][group][name]" }
      rename => { "user.hash" => "[user][hash]" }
      rename => { "user.id" => "[user][id]" }
      rename => { "user.name" => "[user][name]" }
      rename => { "user.name.text" => "[user][name][text]" }
      rename => { "user.roles" => "[user][roles]" }
      rename => { "user.target.domain" => "[user][target][domain]" }
      rename => { "user.target.email" => "[user][target][email]" }
      rename => { "user.target.full_name" => "[user][target][full_name]" }
      rename => { "user.target.full_name.text" => "[user][target][full_name][text]" }
      rename => { "user.target.group.domain" => "[user][target][group][domain]" }
      rename => { "user.target.group.id" => "[user][target][group][id]" }
      rename => { "user.target.group.name" => "[user][target][group][name]" }
      rename => { "user.target.hash" => "[user][target][hash]" }
      rename => { "user.target.id" => "[user][target][id]" }
      rename => { "user.target.name" => "[user][target][name]" }
      rename => { "user.target.name.text" => "[user][target][name][text]" }
      rename => { "user.target.roles" => "[user][target][roles]" }
      rename => { "user.title" => "[user][title]" }
      rename => { "user_agent.device.name" => "[user_agent][device][name]" }
      rename => { "user_agent.name" => "[user_agent][name]" }
      rename => { "user_agent.original" => "[user_agent][original]" }
      rename => { "user_agent.original.text" => "[user_agent][original][text]" }
      rename => { "user_agent.os.family" => "[user_agent][os][family]" }
      rename => { "user_agent.os.full" => "[user_agent][os][full]" }
      rename => { "user_agent.os.full.text" => "[user_agent][os][full][text]" }
      rename => { "user_agent.os.kernel" => "[user_agent][os][kernel]" }
      rename => { "user_agent.os.name" => "[user_agent][os][name]" }
      rename => { "user_agent.os.name.text" => "[user_agent][os][name][text]" }
      rename => { "user_agent.os.platform" => "[user_agent][os][platform]" }
      rename => { "user_agent.os.type" => "[user_agent][os][type]" }
      rename => { "user_agent.os.version" => "[user_agent][os][version]" }
      rename => { "user_agent.version" => "[user_agent][version]" }
      rename => { "vulnerability.category" => "[vulnerability][category]" }
      rename => { "vulnerability.classification" => "[vulnerability][classification]" }
      rename => { "vulnerability.description" => "[vulnerability][description]" }
      rename => { "vulnerability.description.text" => "[vulnerability][description][text]" }
      rename => { "vulnerability.enumeration" => "[vulnerability][enumeration]" }
      rename => { "vulnerability.exception" => "[vulnerability][exception]" }
      rename => { "vulnerability.exploitable" => "[vulnerability][exploitable]" }
      rename => { "vulnerability.id" => "[vulnerability][id]" }
      rename => { "vulnerability.recurrence" => "[vulnerability][recurrence]" }
      rename => { "vulnerability.reference" => "[vulnerability][reference]" }
      rename => { "vulnerability.report_id" => "[vulnerability][report_id]" }
      rename => { "vulnerability.scanner.vendor" => "[vulnerability][scanner][vendor]" }
      rename => { "vulnerability.score.base" => "[vulnerability][score][base]" }
      rename => { "vulnerability.score.environmental" => "[vulnerability][score][environmental]" }
      rename => { "vulnerability.score.temporal" => "[vulnerability][score][temporal]" }
      rename => { "vulnerability.score.version" => "[vulnerability][score][version]" }
      rename => { "vulnerability.severity" => "[vulnerability][severity]" }
      rename => { "vulnerability.status" => "[vulnerability][status]" }
    }

    # Remove custom shipper topic name
    mutate {
      remove_field => ["log_source_type"]
    }
    # remove fields which are not convertible to ecs datatypes
    ruby {
      code => '
        long_fields = [
          "[client][bytes]",
          "[client][packets]",
          "[client][port]",
          "[destination][bytes]",
          "[destination][packets]",
          "[destination][port]",
          "[event][duration]",
          "[event][severity]",
          "[file][x509][public_key_exponent]",
          "[network][bytes]",
          "[network][packets]",
          "[process][parent][pid]",
          "[process][pid]",
          "[server][bytes]",
          "[server][packets]",
          "[server][port]",
          "[source][bytes]",
          "[source][packets]",
          "[source][port]",
          "[client][as][number]",
          "[client][nat][port]",
          "[destination][as][number]",
          "[destination][nat][port]",
          "[dns][answers][ttl]",
          "[event][sequence]",
          "[file][size]",
          "[file][x509][public_key_size]",
          "[host][disk][read][bytes]",
          "[host][disk][write][bytes]",
          "[host][network][egress][bytes]",
          "[host][network][egress][packets]",
          "[host][network][ingress][bytes]",
          "[host][network][ingress][packets]",
          "[host][uptime]",
          "[http][request][body][bytes]",
          "[http][request][bytes]",
          "[http][response][body][bytes]",
          "[http][response][bytes]",
          "[http][response][status_code]",
          "[log][origin][file][line]",
          "[log][syslog][facility][code]",
          "[log][syslog][priority]",
          "[log][syslog][severity][code]",
          "[observer][ingress][interface][host_count]",
          "[package][size]",
          "[process][args_count]",
          "[process][exit_code]",
          "[process][parent][args_count]",
          "[process][parent][exit_code]",
          "[process][parent][pgid]",
          "[process][parent][ppid]",
          "[process][parent][thread][id]",
          "[process][parent][uptime]",
          "[process][pgid]",
          "[process][ppid]",
          "[process][thread][id]",
          "[process][uptime]",
          "[server][as][number]",
          "[server][nat][port]",
          "[source][as][number]",
          "[source][nat][port]",
          "[tls][client][x509][public_key_exponent]",
          "[tls][client][x509][public_key_size]",
          "[tls][server][x509][public_key_exponent]",
          "[tls][server][x509][public_key_size]",
          "[url][port]"
        ]
        float_fields = [
          "[event][risk_score]",
          "[event][risk_score_norm]",
          "[host][cpu][usage]",
          "[vulnerability][score][base]",
          "[vulnerability][score][environmental]",
          "[vulnerability][score][temporal]"
          ]

        float_fields.each do |k|
          field_value = event.get(k)
          if field_value != nil
            begin
              converted_v = Float(field_value)
              event.set(k, converted_v)
            rescue
              event.remove(k)
            end
          end
        end

        long_fields.each do |k|
          field_value = event.get(k)
          if field_value != nil
            begin
              converted_v = Integer(field_value)
              event.set(k, converted_v)
            rescue
              event.remove(k)
            end
          end
        end
      '
      tag_on_exception => "enrichment_data_type_ruby_exception"
    }
    ### Validate IP data types
    mutate {
      strip => ["[client][ip]", "[client][nat][ip]", "[destination][ip]", "[destination][nat][ip]", "[dns][resolved_ip]", "[host][ip]", "[network][forwarded_ip]", "[observer][ip]", "[server][ip]", "[server][nat][ip]", "[source][ip]", "[source][nat][ip]"]
    }

    # [log][source][ip]
    if [log][source][ip] {
      if [log][source][ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![log][source][ip][0] {
        if ![log][source][hostname] {
          mutate {
            copy => { "[log][source][ip]" => "[log][source][hostname]" }
          }
        }
        mutate {
          add_tag => [ "invalid ip format [log][source][ip]" ]
          remove_field => ["[log][source][ip]"]
        }
      }
    }
    # [source][ip]	[source][address]
    if [source][ip] {
      if [source][ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![source][ip][0] {
        if ![source][address] {
          mutate {
            copy => { "[source][ip]" => "[source][address]" }
          }
        }
        mutate {
          add_tag => [ "invalid ip format [source][ip]" ]
          remove_field => ["[source][ip]"]
        }
      }
    }
    # [client][ip]	[client][address]
    if [client][ip] {
      if [client][ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![client][ip][0] {
        if ![client][address] {
          mutate {
            copy => { "[client][ip]" => "[client][address]" }
          }
        }
        mutate {
          add_tag => [ "invalid ip format [client][ip]" ]
          remove_field => ["[client][ip]"]
        }
      }
    }
    # [client][nat][ip]	drop field
    if [client][nat][ip] {
      if [client][nat][ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![client][nat][ip][0] {
        mutate {
          remove_field => ["[client][nat][ip]"]
          add_tag => [ "invalid ip format [client][nat][ip]" ]
        }
      }
    }
    # [destination][ip]	[destination][address]
    if [destination][ip] {
      if [destination][ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![destination][ip][0] {
        if ![destination][address] {
          mutate {
            copy => { "[destination][ip]" => "[destination][address]" }
          }
        }
        mutate {
          add_tag => [ "invalid ip format [destination][ip]" ]
          remove_field => ["[destination][ip]"]
        }
      }
    }
    # [destination][nat][ip] drop field
    if [destination][nat][ip] {
      if [destination][nat][ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![destination][nat][ip][0] {
        mutate {
          remove_field => ["[destination][nat][ip]"]
          add_tag => [ "invalid ip format [destination][nat][ip]" ]
        }
      }
    }
    # [dns][resolved_ip]	[dns][answers][name]
    if [dns][resolved_ip] {
      if [dns][resolved_ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![dns][resolved_ip][0]{
        if ![dns][answers][name] {
          mutate {
            copy => { "[dns][resolved_ip]" => "[dns][answers][name]" }
          }
        }
        mutate {
          add_tag => [ "invalid ip format [dns][resolved_ip]" ]
          remove_field => ["[dns][resolved_ip]"]
        }
      }
    }
    # [host][ip]	[host][hostname]
    if [host][ip] {
      if [host][ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![host][ip][0] {
        if ![host][hostname] {
          mutate {
            copy => { "[host][ip]" => "[host][hostname]" }
          }
        }
        mutate {
          add_tag => [ "invalid ip format [host][ip]" ]
          remove_field => ["[host][ip]"]
        }
      }
    }
    # network.forwarded_ip	drop field
    if [network][forwarded_ip] {
      if [network][forwarded_ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![network][forwarded_ip][0] {
        mutate {
          remove_field => ["[network][forwarded_ip]"]
          add_tag => [ "invalid ip format [network][forwarded_ip]" ]
        }
      }
    }
    # [observer][ip]	[observer][name]
    if [observer][ip] {
      if [observer][ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![observer][ip][0] {
        if ![observer][name] {
          mutate {
            copy => { "[observer][ip]" => "[observer][name]" }
          }
        }
        mutate {
          add_tag => [ "invalid ip format [observer][ip]" ]
          remove_field => ["[observer][ip]"]
        }
      }
    }
    # related.ip	n/a if all fields are fixed before adding to related field then will not have issue

    # [server][ip]	[server][address]
    if [server][ip] {
      if [server][ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![server][ip][0] {
        if ![server][name] {
          mutate {
            copy => { "[server][ip]" => "[server][name]" }
          }
        }
        mutate {
          add_tag => [ "invalid ip format [server][ip]" ]
          remove_field => ["[server][ip]"]
        }
      }
    }
    # [server][nat][ip]	drop field
    if [server][nat][ip] {
      if [server][nat][ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![server][nat][ip][0] {
        mutate {
          remove_field => ["[server][nat][ip]"]
          add_tag => [ "invalid ip format [server][nat][ip]" ]
        }
      }
    }
    # [source][nat][ip]	drop field
    if [source][nat][ip] {
      if [source][nat][ip] !~ "^\d+\.\d+\.\d+\.\d+$" and ![server][nat][ip][0] {
        mutate {
          remove_field => ["[source][nat][ip]"]
          add_tag => [ "invalid ip format [source][nat][ip]" ]
        }
      }
    }

    ### Drop unparsed date fields and add tag
    ruby {
      code => '
        # field names to check with their corresponding failure tags
        date_fields_hash = {
          "[event][created]" => "_dateparsefailure_ec",
          "[event][end]" => "_dateparsefailure_ee",
          "[event][ingested]" => "_dateparsefailure_ei",
          "[event][start]" => "_dateparsefailure_es",
          "[file][accessed]" => "_dateparsefailure_fa",
          "[file][created]" => "_dateparsefailure_fc",
          "[file][ctime]" => "_dateparsefailure_fct",
          "[file][mtime]" => "_dateparsefailure_fm",
          "[package][installed]" => "_dateparsefailure_pi",
          "[process][parent][start]" => "_dateparsefailure_pps",
          "[process][start]" => "_dateparsefailure_ps",
          "[tls][client][not_after]" => "_dateparsefailure_tcna",
          "[tls][client][not_before]" => "_dateparsefailure_tcnb",
          "[tls][server][not_after]" => "_dateparsefailure_tsna",
          "[tls][server][not_before]" => "_dateparsefailure_tsnb"
        }
        # for each field in the above has, check if the value in the event is a string
        # if yes, remove that field and add the corresponding tag,
        date_fields_hash.each do |k,v|
          if event.get(k).is_a? String
            event.remove(k)
            event.tag(v)
          end
        end
      '
    }
  }
}
