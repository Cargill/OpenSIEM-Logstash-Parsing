input {
  pipeline {
    address => VAR_PIPELINE_NAME
  }
}
filter {
  json {
    source => "message"
    target => "az"
  }
  mutate {
    rename => {"[az][category]" => "rule.category"}

    rename => {"[az][id]" => "event.id"}
#     rename => {"[az][incidentid]" => ""}
    rename => {"[az][investigationId]" => "group.id"}
#     rename => {"[az][assignedto]" => ""}
    rename => {"[az][severity]" => "event.severity_name"}
    rename => {"[az][status]" => "event.outcome"}
#     rename => {"[az][classification]" => ""}
    rename => {"[az][determination]" => "event.type"}
#     rename => {"[az][investigationstate]" => ""}
    rename => {"[az][detectionSource]" => "observer.product"}
#     rename => {"[az][detectorid]" => ""}
    rename => {"[az][category]" => "rule.category"}
#     rename => {"[az][threatfamilyname]" => ""}
    rename => {"[az][title]" => "event.kind"}
    rename => {"[az][description]" => "rule.description"}
    rename => {"[az][alertCreationTime]" => "event.created"}
    rename => {"[az][firstEventTime]" => "event.start"}
    rename => {"[az][lastEventTime]" => "event.end"}
    rename => {"[az][lastUpdateTime]" => "event.modified"}
    rename => {"[az][machineId]" => "host.id"}
    rename => {"[az][computerDnsName]" => "host.hostname"}
#     rename => {"[az][rbacgroupname]" => ""}
#     rename => {"[az][aadtenantid]" => ""}
#     rename => {"[az][threatname]" => ""}
#     rename => {"[az][mitreTechniques]" => ""}
    rename => {"[az][relatedUser]" => "user.name"}
#     rename => {"[az][comments]" => ""}
#     rename => {"[az][evidence]" => ""}
  }
}
output {
  pipeline { send_to => [enrichments] }
}