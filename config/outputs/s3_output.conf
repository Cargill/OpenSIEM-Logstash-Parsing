input {
  pipeline { address => s3_output }
}
output {
  s3 {
    region => "us-east-1"
    bucket => "VAR_BUCKET_NAME" # bucket name is different in dev and prod
    codec => "json_lines"
    server_side_encryption => true # encryption at rest (AES)
    upload_queue_size => 4 # number is for files not logs so should be good
    size_file => 5242880 # 5mb default
    time_file => 15 # 15 minutes default
    rotation_strategy => "size_and_time" # first one to match rotates the file
    prefix => "VAR_S3_PREFIX" # folder name, config name would be the folder name
    encoding => gzip # compress the 15 minutes or 5 mb logs before sending
    upload_workers_count=> 8 # increase to 8 from default 4
  }
}